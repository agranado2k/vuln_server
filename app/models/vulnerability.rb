# frozen_string_literal: true

class Vulnerability

  def check(params)
    vulnerabilities.select { |p| p[:group_id] == params[:group_id] }
      .select { |p| p[:artifact_id] == params[:artifact_id] }
      .select { |p| p[:version] == params[:version] }
      .map { |p| format(p) }
  end

  private

    def vulnerabilities
      [
        { rank: 'M', name: 'Improper Authentication', group_id: 'com.example.my_group', artifact_id: 'my_package', version: '1.0.0' }
      ]
    end

    def format(vuln)
      {
        rank: vuln[:rank],
        name: vuln[:name],
        package: "#{vuln[:group_id]}:#{vuln[:artifact_id]}:#{vuln[:version]}"
      }
    end
end
